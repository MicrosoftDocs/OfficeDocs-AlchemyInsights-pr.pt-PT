---
title: Problemas de autenticação
ms.author: v-smandalika
author: v-smandalika
manager: dansimp
ms.date: 01/25/2021
ms.audience: Admin
ms.topic: article
ms.service: o365-administration
ROBOTS: NOINDEX, NOFOLLOW
localization_priority: Priority
ms.collection: Adm_O365
ms.custom:
- "7748"
- "9004339"
ms.openlocfilehash: 2f413e863e6aa23548e425de5901f8158e1d48ab
ms.sourcegitcommit: ba3118b7ad5e02756d0e5c2113245090f54370af
ms.translationtype: HT
ms.contentlocale: pt-PT
ms.lasthandoff: 01/25/2021
ms.locfileid: "49976860"
---
# <a name="authentication-issues"></a><span data-ttu-id="62114-102">Problemas de autenticação</span><span class="sxs-lookup"><span data-stu-id="62114-102">Authentication issues</span></span>

<span data-ttu-id="62114-103">**Está à procura de informações sobre os códigos de erro AADSTS devolvidos a partir do serviço de token de segurança (STS) do Azure Active Directory (Azure AD)?**</span><span class="sxs-lookup"><span data-stu-id="62114-103">**Looking for information about the AADSTS error codes that are returned from the Azure Active Directory (Azure AD) security token service (STS)?**</span></span> <span data-ttu-id="62114-104">Consulte os [códigos de erro de autenticação e autorização do Azure AD](https://docs.microsoft.com/azure/active-directory/develop/reference-aadsts-error-codes) para localizar descrições de erros AADSTS, correções e algumas soluções sugeridas.</span><span class="sxs-lookup"><span data-stu-id="62114-104">See [Azure AD Authentication and authorization error codes](https://docs.microsoft.com/azure/active-directory/develop/reference-aadsts-error-codes) to find AADSTS error descriptions, fixes, and some suggested workarounds.</span></span>

<span data-ttu-id="62114-105">Os erros de autorização podem ser um resultado de vários problemas diferentes, a maioria dos quais gera um erro 401 ou 403.</span><span class="sxs-lookup"><span data-stu-id="62114-105">Authorization errors can be a result of several different issues, most of which generate a 401 or 403 error.</span></span> <span data-ttu-id="62114-106">Por exemplo, os seguintes problemas podem causar erros de autorização:</span><span class="sxs-lookup"><span data-stu-id="62114-106">For example, the following issues can all lead to authorization errors:</span></span>

- <span data-ttu-id="62114-107">[Fluxos de aquisição de token de acesso](https://docs.microsoft.com/azure/active-directory/develop/authentication-vs-authorization) incorreto</span><span class="sxs-lookup"><span data-stu-id="62114-107">Incorrect [access token acquisition flows](https://docs.microsoft.com/azure/active-directory/develop/authentication-vs-authorization)</span></span> 
- <span data-ttu-id="62114-108">[Âmbitos de permissão](https://docs.microsoft.com/azure/active-directory/develop/v2-permissions-and-consent) mal configurados</span><span class="sxs-lookup"><span data-stu-id="62114-108">Poorly configured [permission scopes](https://docs.microsoft.com/azure/active-directory/develop/v2-permissions-and-consent)</span></span> 
- <span data-ttu-id="62114-109">Falta de [consentimento](https://docs.microsoft.com/azure/active-directory/develop/howto-convert-app-to-be-multi-tenant#understanding-user-and-admin-consent)</span><span class="sxs-lookup"><span data-stu-id="62114-109">Lack of [consent](https://docs.microsoft.com/azure/active-directory/develop/howto-convert-app-to-be-multi-tenant#understanding-user-and-admin-consent)</span></span>

<span data-ttu-id="62114-110">Para resolver erros de autorização comuns, experimente os passos indicados abaixo que melhor se adequam ao erro que está a receber.</span><span class="sxs-lookup"><span data-stu-id="62114-110">To resolve common authorization errors, try the steps provided below which most closely match the error you are receiving.</span></span> <span data-ttu-id="62114-111">Pode aplicar mais do que um passo para um erro que está a receber.</span><span class="sxs-lookup"><span data-stu-id="62114-111">More than one step may apply for an error you are receiving.</span></span>

<span data-ttu-id="62114-112">**401 erro Não autorizado: o seu token é válido?**</span><span class="sxs-lookup"><span data-stu-id="62114-112">**401 Unauthorized error: Is your token valid?**</span></span>

<span data-ttu-id="62114-113">Certifique-se de que a sua aplicação está a apresentar um token de acesso válido para o Microsoft Graph como parte do pedido.</span><span class="sxs-lookup"><span data-stu-id="62114-113">Ensure that your app is presenting a valid access token to Microsoft Graph as part of the request.</span></span> <span data-ttu-id="62114-114">Normalmente, este erro significa que o token de acesso pode estar em falta no cabeçalho do pedido de autenticação HTTP ou que o token é inválido ou expirou.</span><span class="sxs-lookup"><span data-stu-id="62114-114">This error often means that the access token may be missing in the HTTP authenticate request header or that the token is invalid or has expired.</span></span> <span data-ttu-id="62114-115">Recomendamos vivamente que utilize a biblioteca de autenticação da Microsoft (MSAL) para obter aquisição de tokens de acesso.</span><span class="sxs-lookup"><span data-stu-id="62114-115">We strongly recommend that you use the Microsoft Authentication Library (MSAL) for access token acquisition.</span></span> <span data-ttu-id="62114-116">Além disso, este erro pode ocorrer se tentar utilizar um token de acesso delegado concedido a uma conta Microsoft pessoal para aceder a uma API que apenas suporta contas escolares ou profissionais (contas organizacionais).</span><span class="sxs-lookup"><span data-stu-id="62114-116">Additionally, this error may occur if you try to use a delegated access token granted to a personal Microsoft account to access an API that only supports work or school accounts (organizational accounts).</span></span>

<span data-ttu-id="62114-117">**403 erro Proibido: selecionou o conjunto de permissões adequado?**</span><span class="sxs-lookup"><span data-stu-id="62114-117">**403 Forbidden error: Have you chosen the right set of permissions?**</span></span>

<span data-ttu-id="62114-118">Certifique-se de que solicitou o conjunto de permissões correto com base nas APIs do Microsoft Graph invocadas pela sua aplicação.</span><span class="sxs-lookup"><span data-stu-id="62114-118">Ensure that you have requested the correct set of permissions based on the Microsoft Graph APIs your app calls.</span></span> <span data-ttu-id="62114-119">São fornecidas permissões com menos privilégios em todos os tópicos do método de referência da API do Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="62114-119">Recommended least-privileged permissions are provided in all the Microsoft Graph API reference method topics.</span></span> <span data-ttu-id="62114-120">Além disso, as permissões devem ser concedidas à aplicação por parte de um utilizador ou de um administrador.</span><span class="sxs-lookup"><span data-stu-id="62114-120">Additionally, those permissions must be granted to the application by a user or an administrator.</span></span> <span data-ttu-id="62114-121">Normalmente, a concessão de permissões ocorre através de uma página de autorização ou da utilização do painel de registo de aplicações do portal do Azure.</span><span class="sxs-lookup"><span data-stu-id="62114-121">Granting permissions normally happens through a consent page or usage of the Azure Portal application registration blade.</span></span> <span data-ttu-id="62114-122">No painel de **Definições** para a aplicação, clique em **Permissões Necessárias** e, em seguida, em **Conceder Permissões**.</span><span class="sxs-lookup"><span data-stu-id="62114-122">From the **Settings** blade for the application, click **Required Permissions**, and then click **Grant Permissions**.</span></span> <span data-ttu-id="62114-123">Para mais informações, consulte:</span><span class="sxs-lookup"><span data-stu-id="62114-123">For more information, see:</span></span>

- [<span data-ttu-id="62114-124">Permissões do Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="62114-124">Microsoft Graph permissions</span></span>](https://docs.microsoft.com/graph/permissions-reference) 
- [<span data-ttu-id="62114-125">Compreender as permissões e o consentimento do Azure AD</span><span class="sxs-lookup"><span data-stu-id="62114-125">Understanding Azure AD permissions and consent</span></span>](https://docs.microsoft.com/azure/active-directory/develop/v2-permissions-and-consent)

<span data-ttu-id="62114-126">**403 erro Proibido: a aplicação obteve um token para corresponder às permissões selecionadas?**</span><span class="sxs-lookup"><span data-stu-id="62114-126">**403 Forbidden error: Did your app acquire a token to match chosen permissions?**</span></span>

<span data-ttu-id="62114-127">Certifique-se de que os tipos de permissões solicitadas ou concedidas correspondem ao tipo de token de acesso adquirido pela sua aplicação.</span><span class="sxs-lookup"><span data-stu-id="62114-127">Ensure that the types of permissions requested or granted match the type of access token that your app acquires.</span></span> <span data-ttu-id="62114-128">É possível que esteja a pedir e a conceder permissões de aplicações, mas através de tokens de fluxo de código interativo delegados, em vez de tokens de fluxo de credenciais de clientes, ou a pedir e conceder permissões delegadas, mas através de tokens de fluxo de credenciais de clientes em vez de tokens de fluxo de código delegados.</span><span class="sxs-lookup"><span data-stu-id="62114-128">You might be requesting and granting app permissions but using delegated interactive code flow tokens instead of client credential flow tokens, or requesting and granting delegated permissions but using client credential flow tokens instead of delegated code flow tokens.</span></span>

<span data-ttu-id="62114-129">Para obter mais informações relacionadas com a aquisição de tokens, consulte:</span><span class="sxs-lookup"><span data-stu-id="62114-129">For more information related to acquiring tokens, see:</span></span>

- [<span data-ttu-id="62114-130">Obter acesso em nome dos utilizadores e permissões delegadas</span><span class="sxs-lookup"><span data-stu-id="62114-130">Get access on behalf of users and delegated permissions</span></span>](https://docs.microsoft.com/graph/auth-v2-user) 
- [<span data-ttu-id="62114-131">Azure AD v 2.0 - fluxo de código de autorização OAuth 2.0</span><span class="sxs-lookup"><span data-stu-id="62114-131">Azure AD v2.0 - OAuth 2.0 authorization code flow</span></span>](https://docs.microsoft.com/azure/active-directory/develop/v2-oauth2-auth-code-flow) 
- [<span data-ttu-id="62114-132">Obter acesso sem um utilizador (serviço daemon) e permissões de aplicação</span><span class="sxs-lookup"><span data-stu-id="62114-132">Get access without a user (daemon service) and application permissions</span></span>](https://docs.microsoft.com/graph/auth-v2-service) 
- [<span data-ttu-id="62114-133">Azure AD v 2.0-fluxo de credenciais de cliente OAuth 2.0</span><span class="sxs-lookup"><span data-stu-id="62114-133">Azure AD v2.0 - OAuth 2.0 client credentials flow</span></span>](https://docs.microsoft.com/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow)

<span data-ttu-id="62114-134">**403 erro Proibido: repor a palavra-passe**</span><span class="sxs-lookup"><span data-stu-id="62114-134">**403 Forbidden error: Resetting password**</span></span>

<span data-ttu-id="62114-135">Atualmente, não existem permissões de serviço-para-serviço daemon para permissão de aplicações que permitem repor as palavras-passe dos utilizadores.</span><span class="sxs-lookup"><span data-stu-id="62114-135">Currently, there are no application permission daemon service-to-service permissions that allow resetting user passwords.</span></span> <span data-ttu-id="62114-136">Estas APIs só são suportadas ao utilizar fluxos de código interativo delegados com um administrador com sessão iniciada.</span><span class="sxs-lookup"><span data-stu-id="62114-136">These APIs are only supported using the interactive delegated code flows with a signed-in administrator.</span></span> <span data-ttu-id="62114-137">Para obter mais informações, consulte [Permissões do Microsoft Graph](https://docs.microsoft.com/graph/permissions-reference).</span><span class="sxs-lookup"><span data-stu-id="62114-137">For more information, see [Microsoft Graph permissions](https://docs.microsoft.com/graph/permissions-reference).</span></span>

<span data-ttu-id="62114-138">**403 Proibido: o utilizador tem acesso e licença?**</span><span class="sxs-lookup"><span data-stu-id="62114-138">**403 Forbidden: Does the user have access and are they licensed?**</span></span>

<span data-ttu-id="62114-139">Para fluxos de código delegados, o Microsoft Graph avalia se o pedido foi permitido com base nas permissões concedidas à aplicação e nas permissões que o utilizador com sessão iniciada tem.</span><span class="sxs-lookup"><span data-stu-id="62114-139">For delegated code flows, Microsoft Graph evaluates whether the request has been allowed based on the permissions granted to the app and the permissions that the signed-in user has.</span></span> <span data-ttu-id="62114-140">Geralmente, este erro indica que o utilizador não tem privilégios suficientes para executar o pedido **ou** que o utilizador não tem uma licença para os dados que estão a ser acedidos.</span><span class="sxs-lookup"><span data-stu-id="62114-140">Generally, this error indicates that the user is not privileged enough to perform the request **or** the user is not licensed for the data being accessed.</span></span> <span data-ttu-id="62114-141">Apenas os utilizadores com permissões ou licenças necessárias podem efetuar um pedido com êxito.</span><span class="sxs-lookup"><span data-stu-id="62114-141">Only users with the required permissions or licenses can make the request successfully.</span></span>

<span data-ttu-id="62114-142">**403 Proibido: selecionou a API de recurso correta?**</span><span class="sxs-lookup"><span data-stu-id="62114-142">**403 Forbidden: Did you select the correct resource API?**</span></span>

<span data-ttu-id="62114-143">Os serviços de API como o Microsoft Graph verificam se o pedido *aud* (audiência) no token de acesso recebido corresponde ao valor esperado para si. Caso contrário, será devolvido um erro 403 Proibido.</span><span class="sxs-lookup"><span data-stu-id="62114-143">API services like Microsoft Graph check that the *aud* claim (audience) in the received access token matches the value it expects for itself, and if not, a 403 Forbidden error occurs.</span></span> <span data-ttu-id="62114-144">Um procedimento incorreto que resulta neste erro é tentar utilizar um token adquirido para as APIs do Azure AD Graph, APIs do Outlook ou para as APIs do SharePoint/OneDrive para invocar o Microsoft Graph (ou vice-versa).</span><span class="sxs-lookup"><span data-stu-id="62114-144">A common mistake resulting in this error is trying to use a token acquired for Azure AD Graph APIs, Outlook APIs, or SharePoint/OneDrive APIs to call Microsoft Graph (or vice versa).</span></span> <span data-ttu-id="62114-145">Certifique-se de que o recurso (ou âmbito) da sua aplicação está a adquirir um token para corresponder à API que a aplicação está a invocar.</span><span class="sxs-lookup"><span data-stu-id="62114-145">Ensure that the resource (or scope) your app is acquiring a token for matches the API that the app is calling.</span></span>

<span data-ttu-id="62114-146">**400 Pedido Inválido ou 403 Proibido: o utilizador cumpre as políticas de acesso condicional (AC) da sua organização?**</span><span class="sxs-lookup"><span data-stu-id="62114-146">**400 Bad Request or 403 Forbidden: Does the user comply with their organization's conditional access (CA) policies?**</span></span>

<span data-ttu-id="62114-147">Com base nas políticas de acesso condicional (AC) de uma organização, um utilizador que aceda aos recursos do Microsoft Graph através da sua aplicação poderá ser confrontado com a necessidade de informações adicionais que não estão presentes no token de acesso que a sua aplicação obteve originalmente.</span><span class="sxs-lookup"><span data-stu-id="62114-147">Based on an organization's conditional access (CA) policies, a user accessing Microsoft Graph resources via your app may be challenged for additional information that is not present in the access token your app originally acquired.</span></span> <span data-ttu-id="62114-148">Neste caso, a sua aplicação receberá um erro **400 com *interaction_required*** durante a aquisição de token de acesso ou um erro **403 com *insufficient_claims*** ao invocar o Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="62114-148">In this case, your app receives a **400 with an *interaction_required*** error during access token acquisition or a **403 with *insufficient_claims*** error when calling Microsoft Graph.</span></span> <span data-ttu-id="62114-149">Em ambos os casos, a resposta de erro contém informações adicionais que podem ser apresentadas ao ponto final autorizado para pedir informações adicionais ao utilizador (como a autenticação multifator ou a inscrição de dispositivos).</span><span class="sxs-lookup"><span data-stu-id="62114-149">In both cases, the error response contains additional information that can be presented to the authorized endpoint to challenge the user for additional information (like multi-factor authentication or device enrollment).</span></span>

<span data-ttu-id="62114-150">Para obter mais informações relacionadas com acesso condicional, consulte:</span><span class="sxs-lookup"><span data-stu-id="62114-150">For more information related to conditional access, see:</span></span>

- [<span data-ttu-id="62114-151">Gerir os pedidos de acesso condicional através do MSAL</span><span class="sxs-lookup"><span data-stu-id="62114-151">Handling conditional access challenges using MSAL</span></span>](https://docs.microsoft.com/azure/active-directory/develop/msal-error-handling-dotnet#conditional-access-and-claims-challenges) 
- [<span data-ttu-id="62114-152">Orientações de acesso condicional ao Azure Active Directory para programadores </span><span class="sxs-lookup"><span data-stu-id="62114-152">Developer guidance for Azure Active Directory conditional access</span></span>](https://docs.microsoft.com/azure/active-directory/develop/v2-conditional-access-dev-guide)

<span data-ttu-id="62114-153">\**_Fim do suporte da Biblioteca de Autenticação do Active Directory (ADAL) e da API do Azure AD Graph (AAD Graph)_* _</span><span class="sxs-lookup"><span data-stu-id="62114-153">\**_End of support for Azure Active Directory Authentication Library (ADAL) and Azure AD Graph API (AAD Graph)_* _</span></span>

- <span data-ttu-id="62114-154">Desde 30 de junho de 2020, deixámos de adicionar novas funcionalidades à Biblioteca de Autenticação do Active Directory (ADAL) e à API do Azure AD Graph (AAD Graph).</span><span class="sxs-lookup"><span data-stu-id="62114-154">Starting June 30th, 2020, we will no longer add any new features to Azure Active Directory Authentication Library (ADAL) and Azure AD Graph API (AAD Graph).</span></span> <span data-ttu-id="62114-155">Continuaremos a fornecer suporte técnico e atualizações de segurança, mas deixaremos de fornecer atualizações de funcionalidades.</span><span class="sxs-lookup"><span data-stu-id="62114-155">We will continue to provide technical support and security updates but will no longer provide feature updates.</span></span>
- <span data-ttu-id="62114-156">A partir de 30 de junho de 2022, iremos terminar o suporte para o ADAL e para o AAD Graph e deixaremos de fornecer suporte técnico ou atualizações de segurança.</span><span class="sxs-lookup"><span data-stu-id="62114-156">Starting June 30th, 2022, we will end support for ADAL and AAD Graph and will no longer provide technical support or security updates.</span></span>
    - <span data-ttu-id="62114-157">As aplicações que utilizam o ADAL em versões existentes do SO continuarão a funcionar após esta data mas não terão suporte técnico ou atualizações de segurança.</span><span class="sxs-lookup"><span data-stu-id="62114-157">Apps using ADAL on existing OS versions will continue to work after this time but will not get any technical support or security updates.</span></span>
    - <span data-ttu-id="62114-158">As aplicações que utilizem o AAD Graph após esta altura poderão deixar de receber respostas do ponto final do AAD Graph.</span><span class="sxs-lookup"><span data-stu-id="62114-158">Apps using AAD Graph after this time may no longer receive responses from the AAD Graph endpoint.</span></span>

<span data-ttu-id="62114-159">_ *Migração da ADAL*\*</span><span class="sxs-lookup"><span data-stu-id="62114-159">_ *ADAL Migration*\*</span></span>

<span data-ttu-id="62114-160">Recomendamos que atualize para a [Biblioteca de Autenticação da Microsoft (MSAL)](https://docs.microsoft.com/azure/active-directory/develop/v2-overview), que tem as funcionalidades e atualizações de segurança mais recentes.</span><span class="sxs-lookup"><span data-stu-id="62114-160">We recommend updating to the [Microsoft Authentication Library (MSAL)](https://docs.microsoft.com/azure/active-directory/develop/v2-overview), which has the latest features and security updates.</span></span> <span data-ttu-id="62114-161">Esta recomendação insere-se no contexto da migração, por parte da Microsoft, de aplicações para a MSAL na data-limite para o fim do suporte.</span><span class="sxs-lookup"><span data-stu-id="62114-161">This recommendation is in the context of Microsoft migrating its applications to MSAL by the end-of-support deadline.</span></span> <span data-ttu-id="62114-162">O objetivo da migração das aplicações Microsoft para o MSAL é garantir que as aplicações beneficiam das melhorias de funcionalidades e segurança contínua da MSAL.</span><span class="sxs-lookup"><span data-stu-id="62114-162">The objective of Microsoft apps' migration to MSAL is to ensure that the apps benefit from MSAL's ongoing security and feature improvements.</span></span>

- [<span data-ttu-id="62114-163">Consulte as FAQ da ADAL</span><span class="sxs-lookup"><span data-stu-id="62114-163">Read the ADAL FAQ</span></span>](https://docs.microsoft.com/azure/active-directory/develop/msal-migration#frequently-asked-questions-faq) 
- [<span data-ttu-id="62114-164">Saiba mais sobre como migrar aplicações por plataforma</span><span class="sxs-lookup"><span data-stu-id="62114-164">Learn about how to migrate apps on a per-platform basis</span></span>](https://docs.microsoft.com/azure/active-directory/develop/msal-migration#frequently-asked-questions-faq) 
- <span data-ttu-id="62114-165">Se precisar de ajuda para compreender qual das suas aplicações utiliza o ADAL, recomendamos que consulte todos os códigos de origem das aplicações e, se aplicável, contacte os fornecedores de software independentes (ISVs) ou fornecedores de aplicações.</span><span class="sxs-lookup"><span data-stu-id="62114-165">If you need help understanding which of your apps use ADAL, we recommend you review all of your apps' source code, and if applicable, reach out to any independent software vendors (ISVs) or app providers.</span></span> <span data-ttu-id="62114-166">O suporte da Microsoft também pode fornecer-lhe uma lista de todas as aplicações de ADAL no seu inquilino que não sejam da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="62114-166">Microsoft support can also provide you with a list of all non-Microsoft ADAL apps in your tenant.</span></span>

<span data-ttu-id="62114-167">**Migração do AAD Graph**</span><span class="sxs-lookup"><span data-stu-id="62114-167">**AAD Graph Migration**</span></span>

<span data-ttu-id="62114-168">Para as aplicações que utilizam o AAD Graph, siga as nossas orientações para [migrar as aplicações do Azure AD Graph para o Microsoft Graph](https://docs.microsoft.com/graph/migrate-azure-ad-graph-planning-checklist?view=graph-rest-1.0&preserve-view=true).</span><span class="sxs-lookup"><span data-stu-id="62114-168">For applications that are using AAD Graph, follow our guidance to [migrate Azure AD Graph apps to Microsoft Graph](https://docs.microsoft.com/graph/migrate-azure-ad-graph-planning-checklist?view=graph-rest-1.0&preserve-view=true).</span></span>

- <span data-ttu-id="62114-169">[A nossa lista de verificação de migração inclui um ponto sobre introdução](https://docs.microsoft.com/graph/migrate-azure-ad-graph-planning-checklist).</span><span class="sxs-lookup"><span data-stu-id="62114-169">[Our migration checklist provides a getting started point](https://docs.microsoft.com/graph/migrate-azure-ad-graph-planning-checklist).</span></span> 
- <span data-ttu-id="62114-170">O portal de registo da sua aplicação Azure mostra as aplicações que estão a utilizar o AAD Graph.</span><span class="sxs-lookup"><span data-stu-id="62114-170">Your Azure app registration portal shows which applications are using AAD Graph.</span></span> <span data-ttu-id="62114-171">Recomendamos que consulte todos os códigos de origem das aplicações e, se aplicável, contacte os ISVs ou fornecedores de aplicações.</span><span class="sxs-lookup"><span data-stu-id="62114-171">We recommend you review all of your apps' source code, and if applicable, reach out to any ISVs or app providers.</span></span> <span data-ttu-id="62114-172">O suporte da Microsoft também pode fornecer-lhe as informações sobre a toda a utilização do AAD Graph no seu inquilino.</span><span class="sxs-lookup"><span data-stu-id="62114-172">Microsoft support can also provide you the information of all AAD Graph usage in your tenant.</span></span>

 










